# –û–±—â–∏–π –º–µ—Ö–∞–Ω–∏–∑–º
StarRocks —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å —ç—Ç–æ–π —Å–∏—Ç—É–∞—Ü–∏–µ–π **—Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ –∏–Ω–∞—á–µ**, —á–µ–º ClickHouse, –∏ –≤ —ç—Ç–æ–º –æ–¥–Ω–æ –∏–∑ –µ–≥–æ –∫–ª—é—á–µ–≤—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤.

### üÜö –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤ –∫ —á–∞—Å—Ç—ã–º –º–µ–ª–∫–∏–º –≤—Å—Ç–∞–≤–∫–∞–º

| –ê—Å–ø–µ–∫—Ç | **ClickHouse** | **StarRocks** |
| :--- | :--- | :--- |
| **–ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å** | **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∞–≥—Ä–µ–≥–∞—Ü–∏—è –≤ —Ñ–æ–Ω–µ** | **–°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ —Å–ª–∏—è–Ω–∏–µ –≤ –ø–∞–º—è—Ç–∏ + –í–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç—å** |
| **–ú–µ—Ö–∞–Ω–∏–∑–º** | –î–∞–Ω–Ω—ã–µ –ø–∏—à—É—Ç—Å—è –≤ **memtable**, –∑–∞—Ç–µ–º –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π **–∫—É—Å–æ–∫ (part)** –Ω–∞ –¥–∏—Å–∫–µ. –ß–∞—Å—Ç—ã–µ –≤—Å—Ç–∞–≤–∫–∏ —Å–æ–∑–¥–∞—é—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –º–µ–ª–∫–∏—Ö –∫—É—Å–∫–æ–≤. | –î–∞–Ω–Ω—ã–µ –ø–∏—à—É—Ç—Å—è –≤ **Memory MemTable**. –ü—Ä–∏ –∫–æ–º–º–∏—Ç–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è **–≤–µ—Ä—Å–∏—è Rowset** –≤ –ø–∞–º—è—Ç–∏. |
| **–ü—Ä–æ–±–ª–µ–º–∞** | **"Too many parts"** - —Ç—ã—Å—è—á–∏ –º–µ–ª–∫–∏—Ö –∫—É—Å–∫–æ–≤ —É–±–∏–≤–∞—é—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤. –¢—Ä–µ–±—É–µ—Ç—Å—è —Ñ–æ–Ω–æ–≤–∞—è **Merge** –¥–ª—è –∏—Ö –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è. | –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –≤–µ—Ä—Å–∏–π Rowsets —Ç—Ä–µ–±—É–µ—Ç –∏—Ö –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏. |
| **–†–µ—à–µ–Ω–∏–µ** | –ñ–¥–∞—Ç—å, –∫–æ–≥–¥–∞ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç —Ñ–æ–Ω–æ–≤–∞—è **Merge**, –∏–ª–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–º–µ—Ä—ã –≤—Å—Ç–∞–≤–æ–∫. | **Automatic Compaction** (L0->L1) –∏ **Background Compaction** –æ–±—ä–µ–¥–∏–Ω—è—é—Ç Rowsets. |

### ‚öôÔ∏è –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –≤ StarRocks –ø—Ä–∏ –≤—Å—Ç–∞–≤–∫–µ 1 –º–ª–Ω —Å—Ç—Ä–æ–∫ –ø–æ –æ–¥–Ω–æ–π

**–ù–ï–¢, 1 –º–ª–Ω —Å–µ–≥–º–µ–Ω—Ç–æ–≤ —Å–æ–∑–¥–∞–Ω–æ –Ω–µ –±—É–¥–µ—Ç.** –í–æ—Ç –ø–æ—à–∞–≥–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å:

1.  **–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –∏ MemTable:**
    *   –ö–∞–∂–¥–∞—è –æ–¥–∏–Ω–æ—á–Ω–∞—è –≤—Å—Ç–∞–≤–∫–∞ (`INSERT INTO ... VALUES (...)`) ‚Äî —ç—Ç–æ **–æ—Ç–¥–µ–ª—å–Ω–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è**.
    *   –î–∞–Ω–Ω—ã–µ —Å–Ω–∞—á–∞–ª–∞ –ø–∏—à—É—Ç—Å—è –≤ **MemTable** –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ BE-—É–∑–ª–∞.

2.  **–ö–æ–º–º–∏—Ç –∏ —Å–æ–∑–¥–∞–Ω–∏–µ Rowset:**
    *   –ü—Ä–∏ –∫–æ–º–º–∏—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ MemTable –¥–ª—è —ç—Ç–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ **—Å–µ—Ä–∏–∞–ª–∏–∑—É–µ—Ç—Å—è –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –¥–∏—Å–∫** –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π **Rowset** (–≤–µ—Ä—Å–∏—è –¥–∞–Ω–Ω—ã—Ö).
    *   **–î–∞, —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å–ª–µ 1 –º–ª–Ω –æ–¥–∏–Ω–æ—á–Ω—ã—Ö –≤—Å—Ç–∞–≤–æ–∫ —É –≤–∞—Å –±—É–¥–µ—Ç 1 –º–ª–Ω Rowsets.** –≠—Ç–æ –ø–ª–æ—Ö–∞—è —Å–∏—Ç—É–∞—Ü–∏—è, –∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–∞–∫ **"version avalanche"**.

3.  **–ü—Ä–æ–±–ª–µ–º–∞ "version avalanche":**
    *   –ö–∞–∂–¥—ã–π Rowset ‚Äî —ç—Ç–æ –æ—Ç–¥–µ–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–∞–Ω–Ω—ã—Ö —Ç–∞–±–ª–µ—Ç–∞.
    *   –ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–ø—Ä–æ—Å–∞ –∫ —Ç–∞–∫–æ–º—É —Ç–∞–±–ª–µ—Ç—É, **–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—é –Ω—É–∂–Ω–æ –ø—Ä–æ—á–∏—Ç–∞—Ç—å –∏ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ –≤—Å–µ—Ö 1 –º–ª–Ω Rowsets**.
    *   –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫:
        *   **–†–µ–∑–∫–æ–º—É —Ä–æ—Å—Ç—É –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏**
        *   **–í–∑—Ä—ã–≤–Ω–æ–º—É —Ä–æ—Å—Ç—É –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö**
        *   **–ö–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∏—á–µ—Å–∫–æ–º—É –ø–∞–¥–µ–Ω–∏—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–æ–≤**

### üõ°Ô∏è –ö–∞–∫ StarRocks –±–æ—Ä–µ—Ç—Å—è —Å —ç—Ç–æ–π –ø—Ä–æ–±–ª–µ–º–æ–π

StarRocks –Ω–µ –æ—Å—Ç–∞–≤–ª—è–µ—Ç –≤–∞—Å –æ–¥–∏–Ω –Ω–∞ –æ–¥–∏–Ω —Å —ç—Ç–æ–π –ø—Ä–æ–±–ª–µ–º–æ–π. –£ –Ω–µ–≥–æ –µ—Å—Ç—å –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –∑–∞—â–∏—Ç—ã:

**1. Automatic Compaction (–ö–ª—é—á–µ–≤–æ–µ –æ—Ç–ª–∏—á–∏–µ!)**
*   **Cumulative Compaction:** –ë—ã—Å—Ç—Ä–æ–µ —Ñ–æ–Ω–æ–≤–æ–µ —Å–ª–∏—è–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –º–µ–ª–∫–∏—Ö Rowsets –≤ –±–æ–ª–µ–µ –∫—Ä—É–ø–Ω—ã–µ (–æ–±—ã—á–Ω–æ –¥–æ 10-1000 —à—Ç—É–∫ –∑–∞ —Ä–∞–∑). –≠—Ç–æ –ø–µ—Ä–≤–∞—è –ª–∏–Ω–∏—è –∑–∞—â–∏—Ç—ã.
*   **Base Compaction:** –ë–æ–ª–µ–µ –º–µ–¥–ª–µ–Ω–Ω–æ–µ, –Ω–æ –≥–ª—É–±–æ–∫–æ–µ —Å–ª–∏—è–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –±–æ–ª—å—à–∏–µ Cumulative Rowsets –≤ –±–æ–ª—å—à–∏–µ Base Rowset.

**2. Batch Ingestion (–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–æ–¥—Ö–æ–¥)**
*   StarRocks –Ω–∞—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç **–ø–∞–∫–µ—Ç–Ω—É—é –≤—Å—Ç–∞–≤–∫—É** –¥–∞–Ω–Ω—ã—Ö. –í–º–µ—Å—Ç–æ 1 –º–ª–Ω –æ–¥–∏–Ω–æ—á–Ω—ã—Ö –≤—Å—Ç–∞–≤–æ–∫ –ª—É—á—à–µ —Å–¥–µ–ª–∞—Ç—å 1000 –ø–∞–∫–µ—Ç–æ–≤ –ø–æ 1000 —Å—Ç—Ä–æ–∫.
*   –ü—Ä–∏ –ø–∞–∫–µ—Ç–Ω–æ–π –≤—Å—Ç–∞–≤–∫–µ 1000 —Å—Ç—Ä–æ–∫ –∑–∞ —Ä–∞–∑ —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤—Å–µ–≥–æ **1 Rowset** –≤–º–µ—Å—Ç–æ 1000.

**3. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–º–ø–∞–∫—Ü–∏–∏**
*   –ú–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ø–æ–ª–∏—Ç–∏–∫–∏ –∫–æ–º–ø–∞–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã like:
    *   `cumulative_compaction_num_threads_per_disk` 
    *   `base_compaction_num_threads_per_disk`
    *   `cumulative_compaction_check_interval_seconds`

### üí° –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

*   **–ü—Ä–∏ 1 –º–ª–Ω –æ–¥–∏–Ω–æ—á–Ω—ã—Ö INSERT:** –í –ø–µ—Ä–≤—ã–µ –º–∏–Ω—É—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ —ç—Ç–∏–º –¥–∞–Ω–Ω—ã–º **—Ä–µ–∑–∫–æ —É–ø–∞–¥–µ—Ç**. –ù–æ –∑–∞—Ç–µ–º **automatic compaction –Ω–∞—á–Ω–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å** –∏ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –æ–±—ä–µ–¥–∏–Ω–∏—Ç —ç—Ç–∏ 1 –º–ª–Ω Rowsets –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–µ—Å—è—Ç–∫–æ–≤ –∏–ª–∏ —Å–æ—Ç–µ–Ω —Ä–∞–∑—É–º–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞.

*   **–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç ClickHouse:** –í ClickHouse –≤–∞–º –ø—Ä–∏—à–ª–æ—Å—å –±—ã –∂–¥–∞—Ç—å —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è Merge –∏–ª–∏ –≤—Ä—É—á–Ω—É—é –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É (`OPTIMIZE TABLE`). –í StarRocks —ç—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å –±–æ–ª–µ–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω –∏ —É—Å—Ç–æ–π—á–∏–≤.

*   **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–ª—è –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö OLTP-–ø–æ–¥–æ–±–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **–ø–∞–∫–µ—Ç–Ω—É—é –≤—Å—Ç–∞–≤–∫—É** –∏–ª–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —á–µ—Ä–µ–∑ **Apache Kafka**, –≥–¥–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç—Å—è –≤ –º–∏–∫—Ä–æ–ø–∞–∫–µ—Ç–∞—Ö –ø–µ—Ä–µ–¥ –≤—Å—Ç–∞–≤–∫–æ–π –≤ StarRocks.

**–í—ã–≤–æ–¥:** StarRocks —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å —á–∞—Å—Ç—ã–º–∏ –º–µ–ª–∫–∏–º–∏ –≤—Å—Ç–∞–≤–∫–∞–º–∏ **–ª—É—á—à–µ**, —á–µ–º ClickHouse, –±–ª–∞–≥–æ–¥–∞—Ä—è —Å–≤–æ–µ–π –º–æ–¥–µ–ª–∏ –≤–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç–∏ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ–º–ø–∞–∫—Ü–∏–∏, –Ω–æ —ç—Ç–æ –≤—Å–µ —Ä–∞–≤–Ω–æ **–∞–Ω—Ç–∏-–ø–∞—Ç—Ç–µ—Ä–Ω**, –∫–æ—Ç–æ—Ä–æ–≥–æ —Å–ª–µ–¥—É–µ—Ç –∏–∑–±–µ–≥–∞—Ç—å –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ö–∞—Ñ–∫–∞

–ö–∞—Ñ–∫–∞ **–Ω–µ –æ—Ç–¥–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ** –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Å —Ç–∞–∫–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏, –∫–∞–∫ StarRocks. –í–µ—Å—å —Ñ–æ–∫—É—Å –≤ **–±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –ø–∞–∫–µ—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ** –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä–∞.

### ‚öôÔ∏è –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Kafka -> StarRocks

–í–æ—Ç –ø–æ—à–∞–≥–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ –ö–∞—Ñ–∫–∞ —Å–ø–∞—Å–∞–µ—Ç –æ—Ç –ø—Ä–æ–±–ª–µ–º—ã –æ–¥–∏–Ω–æ—á–Ω—ã—Ö –≤—Å—Ç–∞–≤–æ–∫:

```
[Kafka Topic]
    |
    | (1) Consumer Poll - –∑–∞–±–∏—Ä–∞–µ—Ç *–ø–∞—á–∫—É* —Å–æ–æ–±—â–µ–Ω–∏–π
    v
+-----------------------------------------------------------------+
| [StarRocks Connector]                                           |
|                                                                 |
|  +---------------------+    +-------------------+               |
|  | –ë—É—Ñ–µ—Ä –≤ –ø–∞–º—è—Ç–∏      | -> | –ù–∞–∫–æ–ø–∏–≤—à–∏–π—Å—è      | -> (2) –ü–∞–∫–µ—Ç–Ω–∞—è |
|  | (–Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç        |    | –ø–∞–∫–µ—Ç (Batch)     |     –≤—Å—Ç–∞–≤–∫–∞ –≤   |
|  |  —Å–æ–æ–±—â–µ–Ω–∏—è)         |    | ~10-50k —Å—Ç—Ä–æ–∫     |     StarRocks   |
|  +---------------------+    +-------------------+               |
+-----------------------------------------------------------------+
                                                                   |
                                                                   v
                                                             [StarRocks BE]
                                                             (–°–æ–∑–¥–∞–µ—Ç—Å—è 1 Rowset)
```

### üîç –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏–∏ (—á—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç 1 –º–ª–Ω —Å–µ–≥–º–µ–Ω—Ç–æ–≤)

**1. `batch.size` (–∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä)**
*   **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ö–æ–Ω–Ω–µ–∫—Ç–æ—Ä –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ StarRocks —Å—Ä–∞–∑—É. –û–Ω –Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç –∏—Ö –≤ –±—É—Ñ–µ—Ä –≤ –ø–∞–º—è—Ç–∏.
*   **–ü—Ä–∏–º–µ—Ä:** –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è `batch.size = 10000`. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä –±—É–¥–µ—Ç –∂–¥–∞—Ç—å, –ø–æ–∫–∞ –Ω–µ –Ω–∞–∫–æ–ø–∏—Ç—Å—è 10 000 —Å–æ–æ–±—â–µ–Ω–∏–π, –∏ —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç –∏—Ö –æ–¥–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–µ–π –≤ StarRocks.
*   **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í–º–µ—Å—Ç–æ 1 –º–ª–Ω –æ—Ç–¥–µ–ª—å–Ω—ã—Ö INSERT - –≤—Å–µ–≥–æ **100 –ø–∞–∫–µ—Ç–Ω—ã—Ö –≤—Å—Ç–∞–≤–æ–∫**.

**2. `linger.ms`**
*   **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –¢–∞–π–º–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞–∫–µ—Ç–∞.
*   **–ü—Ä–∏–º–µ—Ä:** `linger.ms = 1000` (1 —Å–µ–∫—É–Ω–¥–∞). –î–∞–∂–µ –µ—Å–ª–∏ –∑–∞ 1 —Å–µ–∫—É–Ω–¥—É –Ω–µ –Ω–∞–±—Ä–∞–ª–æ—Å—å 10 000 —Å–æ–æ–±—â–µ–Ω–∏–π, –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä –≤—Å–µ —Ä–∞–≤–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç —Ç–æ, —á—Ç–æ –µ—Å—Ç—å.
*   **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –Ω–µ –±—É–¥—É—Ç "–∑–∞—Å—Ç—Ä–µ–≤–∞—Ç—å" –≤ –±—É—Ñ–µ—Ä–µ –ø—Ä–∏ –Ω–∏–∑–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ.

**3. –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º –∏ –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ö–∞—Ñ–∫–∏**
*   **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ï—Å–ª–∏ –≤ —Ç–æ–ø–∏–∫–µ –ö–∞—Ñ–∫–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–∞—Ä—Ç–∏—Ü–∏–π, –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è.
*   **–ü—Ä–∏–º–µ—Ä:** –¢–æ–ø–∏–∫ —Å 10 –ø–∞—Ä—Ç–∏—Ü–∏—è–º–∏ ‚Üí 10 –∫–æ–Ω—Å—É–º–µ—Ä–æ–≤ ‚Üí 10 –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –±—É—Ñ–µ—Ä–æ–≤ ‚Üí 10 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –ø–∞–∫–µ—Ç–Ω—ã—Ö –≤—Å—Ç–∞–≤–æ–∫ –≤ —Ä–∞–∑–Ω—ã–µ —Ç–∞–±–ª–µ—Ç—ã StarRocks.
*   **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è, –Ω–æ –∫–∞–∂–¥—ã–π –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–æ—Ç–æ–∫ –≤—Å–µ —Ä–∞–≤–Ω–æ –≤—Å—Ç–∞–≤–ª—è–µ—Ç –ø–∞—á–∫–∞–º–∏.

### üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

| –°—Ü–µ–Ω–∞—Ä–∏–π | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ Rowsets | –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å |
| :--- | :--- | :--- |
| **1 –º–ª–Ω –æ—Ç–¥–µ–ª—å–Ω—ã—Ö JDBC INSERT** | ~1 –º–ª–Ω Rowsets | **–ö–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∏—á–µ—Å–∫–∞—è** |
| **–ö–∞—Ñ–∫–∞ –±–µ–∑ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** | ~1 –º–ª–Ω Rowsets | –ü–ª–æ—Ö–∞—è |
| **–ö–∞—Ñ–∫–∞ —Å `batch.size=1000`** | **~1000 Rowsets** | **–ü—Ä–∏–µ–º–ª–µ–º–∞—è** |
| **–ö–∞—Ñ–∫–∞ —Å `batch.size=10000`** | **~100 Rowsets** | **–•–æ—Ä–æ—à–∞—è** |

### üõ†Ô∏è –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

–í–æ—Ç –∫–∞–∫ –≤—ã–≥–ª—è–¥–µ–ª–∏ –±—ã —Ç–∏–ø–∏—á–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä–∞:

```properties
# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –æ–¥–Ω–æ–º –ø–∞–∫–µ—Ç–µ
batch.size = 10000

# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞–∫–µ—Ç–∞ (–º—Å)
linger.ms = 1000

# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞ –≤ –±–∞–π—Ç–∞—Ö
batch.bytes = 10485760  # 10 MB
```

### üí° –†–µ–∞–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã

1.  **–í—Ö–æ–¥—è—â–∏–π –ø–æ—Ç–æ–∫:** 1000 —Å–æ–æ–±—â–µ–Ω–∏–π/—Å–µ–∫—É–Ω–¥—É –≤ Kafka
2.  **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä–∞:** `batch.size = 5000`, `linger.ms = 5000`
3.  **–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
    *   –ö–æ–Ω–Ω–µ–∫—Ç–æ—Ä –Ω–∞—á–∏–Ω–∞–µ—Ç –Ω–∞–∫–∞–ø–ª–∏–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è
    *   –ß–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥ –Ω–∞–±–∏—Ä–∞–µ—Ç—Å—è ~5000 —Å–æ–æ–±—â–µ–Ω–∏–π
    *   **–û–î–ù–ê** –ø–∞–∫–µ—Ç–Ω–∞—è –≤—Å—Ç–∞–≤–∫–∞ 5000 —Å—Ç—Ä–æ–∫ –≤ StarRocks
    *   –°–æ–∑–¥–∞–µ—Ç—Å—è **–û–î–ò–ù** Rowset –≤–º–µ—Å—Ç–æ 5000
4.  **–ò—Ç–æ–≥:** –ò–∑ 86400 —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –¥–µ–Ω—å —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤—Å–µ–≥–æ ~17 Rowsets –≤–º–µ—Å—Ç–æ 86400

### üéØ –í—ã–≤–æ–¥

**–ö–∞—Ñ–∫–∞ —Å–ø–∞—Å–∞–µ—Ç –Ω–µ –ø—Ä–æ—Å—Ç–æ "—á—Ç–µ–Ω–∏–µ–º", –∞ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–π –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏–µ–π –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä–∞.** –û–Ω–∞ –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –ø–æ—Ç–æ–∫ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –¥–∏—Å–∫—Ä–µ—Ç–Ω—ã–µ –ø–∞–∫–µ—Ç—ã –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–µ StarRocks –º–æ–∂–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å.

–ò–º–µ–Ω–Ω–æ —ç—Ç–æ—Ç –º–µ—Ö–∞–Ω–∏–∑–º **–±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏–∏ + –ø–∞–∫–µ—Ç–Ω–æ–π –≤—Å—Ç–∞–≤–∫–∏** –¥–µ–ª–∞–µ—Ç —Å–≤—è–∑–∫—É Kafka + StarRocks —É—Å—Ç–æ–π—á–∏–≤–æ–π –∫ –ø—Ä–æ–±–ª–µ–º–µ "version avalanche", –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ –ø—Ä—è–º—ã–µ –æ–¥–∏–Ω–æ—á–Ω—ã–µ INSERT'—ã —á–µ—Ä–µ–∑ JDBC —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É —É—Å—É–≥—É–±–ª—è—é—Ç.
