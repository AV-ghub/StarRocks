## ğŸ• Ğ’Ñ€ĞµĞ¼ĞµĞ½Ğ½Ğ°Ñ ÑˆĞºĞ°Ğ»Ğ° Ñ€Ğ°Ğ·Ğ²ĞµÑ€Ñ‚Ñ‹Ğ²Ğ°Ğ½Ğ¸Ñ

```
T0  â†’ ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºĞ° ÑĞµÑ€Ğ²ĞµÑ€Ğ°, ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Flink
T1  â†’ Ğ—Ğ°Ğ¿ÑƒÑĞº ĞºĞ»Ğ°ÑÑ‚ĞµÑ€Ğ° Flink (JobManager, TaskManager)
T2  â†’ ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºĞ° Kafka Ğ¸ PostgreSQL (ĞµÑĞ»Ğ¸ Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğµ)
T3  â†’ Ğ Ğ°Ğ·Ğ²ĞµÑ€Ñ‚Ñ‹Ğ²Ğ°Ğ½Ğ¸Ğµ Debezium Connector Ğ² Flink
T4  â†’ Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ† Ğ² Flink SQL, Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Kafka-Ñ‚Ğ¾Ğ¿Ğ¸ĞºĞ¾Ğ²
T5  â†’ Ğ—Ğ°Ğ¿ÑƒÑĞº Flink Job, Ğ¸Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ ÑĞ»Ğ¾Ñ‚Ğ° Ñ€ĞµĞ¿Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸
T6  â†’ ĞĞ°Ñ‡Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ ÑĞ½Ğ¸Ğ¼Ğ¾Ğº (snapshot) Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
T7  â†’ Ğ˜Ğ½ĞºÑ€ĞµĞ¼ĞµĞ½Ñ‚Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ñ€ĞµĞ¿Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ñ (CDC)
```

---

## ğŸ“¦ Ğ¨Ğ°Ğ³ 0: ĞŸÑ€ĞµĞ´Ğ²Ğ°Ñ€Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ ÑƒÑĞ»Ğ¾Ğ²Ğ¸Ñ (T0)

**Ğ§Ñ‚Ğ¾ ÑƒĞ¶Ğµ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ:**
- Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ½Ñ‹Ğ¹ PostgreSQL (10+) Ñ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ°Ğ¼Ğ¸:
  ```properties
  wal_level = logical
  max_wal_senders = 10
  max_replication_slots = 10
  ```
- Apache Kafka (3.0+) Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ÑÑ‰Ğ¸Ğ¼ Zookeeper/Kraft
- Java 11/17
- Ğ¡ĞµÑ€Ğ²ĞµÑ€ Ñ ~4Ğ“Ğ‘+ RAM

---

## ğŸš€ Ğ¨Ğ°Ğ³ 1: Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ¸ Ğ·Ğ°Ğ¿ÑƒÑĞº Flink (T1)

**Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ:**
```bash
# 1. Ğ¡ĞºĞ°Ñ‡Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ°Ñ€Ñ…Ğ¸Ğ² (Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€ Ğ´Ğ»Ñ Flink 1.18)
wget https://archive.apache.org/dist/flink/flink-1.18.0/flink-1.18.0-bin-scala_2.12.tgz
tar -xzf flink-1.18.0-bin-scala_2.12.tgz
cd flink-1.18.0

# 2. Ğ‘Ğ°Ğ·Ğ¾Ğ²Ğ°Ñ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ (conf/flink-conf.yaml)
jobmanager.rpc.address: localhost
taskmanager.numberOfTaskSlots: 4
parallelism.default: 2

# 3. Ğ—Ğ°Ğ¿ÑƒÑĞº standalone-ĞºĞ»Ğ°ÑÑ‚ĞµÑ€Ğ°
./bin/start-cluster.sh
```

**Ğ§Ñ‚Ğ¾ Ğ¿Ñ€Ğ¾Ğ¸ÑÑ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ²Ğ½ÑƒÑ‚Ñ€Ğ¸:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ğ—Ğ°Ğ¿ÑƒÑĞº Flink ĞºĞ»Ğ°ÑÑ‚ĞµÑ€Ğ°                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. Ğ¡Ñ‚Ğ°Ñ€Ñ‚ÑƒĞµÑ‚ JobManager (Ğ¿Ğ¾Ñ€Ñ‚ 8081)         â”‚
â”‚    â€¢ Web Dashboard                          â”‚
â”‚    â€¢ Ğ”Ğ¸ÑĞ¿ĞµÑ‚Ñ‡ĞµÑ€ Ğ·Ğ°Ğ´Ğ°Ñ‡                        â”‚
â”‚    â€¢ Checkpoint ĞºĞ¾Ğ¾Ñ€Ğ´Ğ¸Ğ½Ğ°Ñ‚Ğ¾Ñ€                 â”‚
â”‚                                             â”‚
â”‚ 2. Ğ¡Ñ‚Ğ°Ñ€Ñ‚ÑƒĞµÑ‚ TaskManager (Ğ¿Ğ¾Ñ€Ñ‚ 8082)        â”‚
â”‚    â€¢ Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ ÑĞ»Ğ¾Ñ‚Ñ‹ (TaskSlots)       â”‚
â”‚    â€¢ Ğ¡ĞµÑ‚ĞµĞ²Ñ‹Ğµ Ğ±ÑƒÑ„ĞµÑ€Ñ‹                         â”‚
â”‚    â€¢ State Backend (Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ Heap)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ°:**
```bash
# ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑÑ‹
jps
# Ğ”Ğ¾Ğ»Ğ¶Ğ½Ñ‹ ÑƒĞ²Ğ¸Ğ´ĞµÑ‚ÑŒ:
# - StandaloneSessionClusterEntryPoint (JobManager)
# - TaskManagerRunner

# Ğ˜Ğ»Ğ¸ Ñ‡ĞµÑ€ĞµĞ· Ğ²ĞµĞ±-Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ
http://localhost:8081
```

---

## ğŸ—ƒï¸ Ğ¨Ğ°Ğ³ 2: ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºĞ° Ğ²Ğ½ĞµÑˆĞ½Ğ¸Ñ… ÑĞ¸ÑÑ‚ĞµĞ¼ (T2)

### A. PostgreSQL
```sql
-- Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ Ğ¿ÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ñ Ğ´Ğ»Ñ Ğ½ÑƒĞ¶Ğ½Ñ‹Ñ… Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†
CREATE PUBLICATION flink_cdc_pub FOR TABLE users, orders;
CREATE USER debezium WITH REPLICATION LOGIN PASSWORD 'secret';
GRANT SELECT ON ALL TABLES IN SCHEMA public TO debezium;

-- ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ ÑĞ»Ğ¾Ñ‚Ñ‹ (Ğ¿Ğ¾ĞºĞ° Ğ¿ÑƒÑÑ‚Ğ¾)
SELECT * FROM pg_replication_slots;
```

### B. Kafka
```bash
# Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ Ñ‚Ğ¾Ğ¿Ğ¸ĞºĞ¸ Ğ´Ğ»Ñ CDC
./bin/kafka-topics.sh --create \
  --topic debezium.pg_cdc \
  --bootstrap-server localhost:9092 \
  --partitions 3 \
  --replication-factor 1
```

---

## ğŸ”Œ Ğ¨Ğ°Ğ³ 3: Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Debezium Ğ² Flink (T3)

**Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ:**
```bash
# 1. Ğ¡ĞºĞ°Ñ‡Ğ¸Ğ²Ğ°ĞµĞ¼ JAR-Ñ„Ğ°Ğ¹Ğ»Ñ‹ ĞºĞ¾Ğ½Ğ½ĞµĞºÑ‚Ğ¾Ñ€Ğ¾Ğ²
cd flink-1.18.0

# Debezium PostgreSQL Connector
wget https://repo1.maven.org/maven2/io/debezium/debezium-connector-postgres/2.4.0.Final/debezium-connector-postgres-2.4.0.Final-plugin.tar.gz
tar -xzf debezium-connector-postgres-2.4.0.Final-plugin.tar.gz -C lib/

# Apache Kafka Connector Ğ´Ğ»Ñ Flink
wget https://repo1.maven.org/maven2/org/apache/flink/flink-connector-kafka/3.1.0-1.18/flink-connector-kafka-3.1.0-1.18.jar -P lib/

# 2. ĞŸĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑĞºĞ°ĞµĞ¼ TaskManager (Ğ²Ğ°Ğ¶Ğ½Ğ¾!)
./bin/taskmanager.sh stop
./bin/taskmanager.sh start
```

**Ğ§Ñ‚Ğ¾ Ğ¿Ñ€Ğ¾Ğ¸ÑÑ…Ğ¾Ğ´Ğ¸Ñ‚:**
- JAR-Ñ„Ğ°Ğ¹Ğ»Ñ‹ ĞºĞ¾Ğ¿Ğ¸Ñ€ÑƒÑÑ‚ÑÑ Ğ² `lib/` Ğ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ñ
- ĞŸÑ€Ğ¸ Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑĞºĞµ TaskManager ÑĞºĞ°Ğ½Ğ¸Ñ€ÑƒĞµÑ‚ Ğ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ñ Ğ¸ Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµÑ‚ ĞºĞ»Ğ°ÑÑÑ‹
- Ğ¢ĞµĞ¿ĞµÑ€ÑŒ Flink Ğ·Ğ½Ğ°ĞµÑ‚ Ğ¾ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ°Ñ… Debezium Ğ¸ Kafka

---

## ğŸ—„ï¸ Ğ¨Ğ°Ğ³ 4: Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ† Ğ² Flink SQL (T4)

**Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°ĞµĞ¼ SQL Client:**
```bash
./bin/sql-client.sh
```

**Ğ’ SQL Client Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ÑĞµĞ¼:**

```sql
-- 1. Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñƒ-Ğ¸ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸Ğº Ğ¸Ğ· Kafka (CDC ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ)
CREATE TABLE users_cdc (
  `before` ROW<id INT, name STRING>,
  `after` ROW<id INT, name STRING>,
  `op` STRING,
  `ts_ms` BIGINT,
  `source` MAP<STRING, STRING>
) WITH (
  'connector' = 'kafka',
  'topic' = 'debezium.pg_cdc',
  'properties.bootstrap.servers' = 'localhost:9092',
  'properties.group.id' = 'flink-cdc-group',
  'scan.startup.mode' = 'earliest-offset',
  'format' = 'debezium-json'
);

-- 2. Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ Ğ¼Ğ°Ñ‚ĞµÑ€Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğµ Ğ¿Ñ€ĞµĞ´ÑÑ‚Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ
CREATE VIEW users_current AS
SELECT 
  `after`.id AS user_id,
  `after`.name AS user_name,
  `op` as operation_type,
  FROM_UNIXTIME(`ts_ms` / 1000) AS change_time
FROM users_cdc
WHERE `op` != 'd';  -- Ğ¸ÑĞºĞ»ÑÑ‡Ğ°ĞµĞ¼ ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¸Ñ
```

---

## ğŸš¦ Ğ¨Ğ°Ğ³ 5: Ğ—Ğ°Ğ¿ÑƒÑĞº Flink Job (T5)

**Ğ¡Ğ¿Ğ¾ÑĞ¾Ğ± 1: Ñ‡ĞµÑ€ĞµĞ· SQL Client (Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾Ğ¹ ÑÑ‚Ğ°Ñ€Ñ‚)**
```sql
-- Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ Ğ¿Ğ¾ÑÑ‚Ğ¾ÑĞ½Ğ½ÑƒÑ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñƒ Ğ´Ğ»Ñ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ²
CREATE TABLE users_summary (
  user_id INT,
  user_name STRING,
  last_update TIMESTAMP(3)
) WITH (
  'connector' = 'print'  -- Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾ Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ¸Ğ¼ Ğ² ĞºĞ¾Ğ½ÑĞ¾Ğ»ÑŒ Ğ´Ğ»Ñ Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ°
);

-- Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°ĞµĞ¼ Ğ½ĞµĞ¿Ñ€ĞµÑ€Ñ‹Ğ²Ğ½Ñ‹Ğ¹ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ
INSERT INTO users_summary
SELECT user_id, user_name, change_time 
FROM users_current;
```

**Ğ§Ñ‚Ğ¾ Ğ¿Ñ€Ğ¾Ğ¸ÑÑ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ² ÑÑ‚Ğ¾Ñ‚ Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚:**

```
1. Flink Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚ SQL-Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ
2. ĞŸĞ»Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ñ‰Ğ¸Ğº ÑĞ¾Ğ·Ğ´Ğ°ĞµÑ‚ Execution Graph:
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Kafka Source (debezium-json format) â”‚
   â”‚   â€¢ ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ°ĞµÑ‚ÑÑ Ğº Kafka brokers    â”‚
   â”‚   â€¢ ĞĞ°Ñ‡Ğ¸Ğ½Ğ°ĞµÑ‚ Ñ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ Ñ earliest      â”‚
   â”‚   â€¢ Ğ”ĞµÑĞµÑ€Ğ¸Ğ°Ğ»Ğ¸Ğ·ÑƒĞµÑ‚ JSON Ğ² RowData    â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚ Filter (WHERE op != 'd')            â”‚
   â”‚   â€¢ ĞÑ‚Ğ±Ñ€Ğ°ÑÑ‹Ğ²Ğ°ĞµÑ‚ DELETE ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ      â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚ Map (Ğ¸Ğ·Ğ²Ğ»ĞµĞºĞ°ĞµÑ‚ Ğ¿Ğ¾Ğ»Ñ)                â”‚
   â”‚   â€¢ `after`.id â†’ user_id            â”‚
   â”‚   â€¢ `after`.name â†’ user_name        â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚ Print Sink                          â”‚
   â”‚   â€¢ Ğ’Ñ‹Ğ²Ğ¾Ğ´Ğ¸Ñ‚ Ğ² stdout TaskManager    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3. JobManager Ñ€Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ÑĞµÑ‚ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸:
   - Source â†’ TaskManager Slot 1
   - Filter/Map â†’ TaskManager Slot 2
   - Sink â†’ TaskManager Slot 3

4. Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ° ÑÑ‚Ğ°Ñ€Ñ‚ÑƒĞµÑ‚, Ğ½Ğ¾ ĞĞ•Ğ¢ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ² Kafka
```

---

## ğŸ“¸ Ğ¨Ğ°Ğ³ 6: Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Debezium (Ğ½Ğ°Ñ‡Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ ÑĞ½Ğ¸Ğ¼Ğ¾Ğº) (T6)

**Ğ’ ÑÑ‚Ğ¾Ñ‚ Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚ Debezium ĞµÑ‰Ğµ Ğ½Ğµ Ğ·Ğ°Ğ¿ÑƒÑ‰ĞµĞ½!** ĞÑƒĞ¶ĞµĞ½ Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ:

```bash
# Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ğ¹ Ñ„Ğ°Ğ¹Ğ» Ğ´Ğ»Ñ Debezium
cat > debezium-config.json << EOF
{
  "name": "postgres-connector",
  "config": {
    "connector.class": "io.debezium.connector.postgresql.PostgresConnector",
    "database.hostname": "localhost",
    "database.port": "5432",
    "database.user": "debezium",
    "database.password": "secret",
    "database.dbname": "mydb",
    "plugin.name": "pgoutput",
    "publication.name": "flink_cdc_pub",
    "slot.name": "flink_slot_001",
    "table.include.list": "public.users",
    "snapshot.mode": "initial",
    "tombstones.on.delete": false,
    "key.converter": "org.apache.kafka.connect.json.JsonConverter",
    "value.converter": "org.apache.kafka.connect.json.JsonConverter",
    "transforms": "unwrap",
    "transforms.unwrap.type": "io.debezium.transforms.ExtractNewRecordState"
  }
}
```

**Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°ĞµĞ¼ Debezium Connector Ñ‡ĞµÑ€ĞµĞ· REST API Kafka Connect:**
```bash
curl -X POST -H "Content-Type: application/json" \
  --data @debezium-config.json \
  http://localhost:8083/connectors
```

**Ğ§Ñ‚Ğ¾ Ğ¿Ñ€Ğ¾Ğ¸ÑÑ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ¿Ğ¾ÑÑ‚Ğ°Ğ¿Ğ½Ğ¾:**

```
Ğ­Ñ‚Ğ°Ğ¿ 1: Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
1. Debezium Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡Ğ°ĞµÑ‚ÑÑ Ğº PostgreSQL
2. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ Ğ½Ğ°Ğ»Ğ¸Ñ‡Ğ¸Ğµ Ğ¿ÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸ flink_cdc_pub
3. Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµÑ‚ ÑĞ»Ğ¾Ñ‚ Ñ€ĞµĞ¿Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸ flink_slot_001
4. Ğ‘Ğ»Ğ¾ĞºĞ¸Ñ€ÑƒĞµÑ‚ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹ Ğ´Ğ»Ñ ÑĞ¾Ğ³Ğ»Ğ°ÑĞ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ ÑĞ½Ğ°Ğ¿ÑˆĞ¾Ñ‚Ğ° (ĞµÑĞ»Ğ¸ Ğ½ÑƒĞ¶Ğ½Ğ¾)

Ğ­Ñ‚Ğ°Ğ¿ 2: ĞĞ°Ñ‡Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ ÑĞ½Ğ¸Ğ¼Ğ¾Ğº (Snapshot)
5. Ğ§Ğ¸Ñ‚Ğ°ĞµÑ‚ Ñ‚ĞµĞºÑƒÑ‰ĞµĞµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹ users
6. Ğ”Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¹ ÑÑ‚Ñ€Ğ¾ĞºĞ¸ Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµÑ‚ INSERT-ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ:
   {
     "before": null,
     "after": {"id": 1, "name": "Alice"},
     "op": "r",  -- 'r' = read (snapshot)
     "ts_ms": ...,
     "source": {"snapshot": "true"}
   }
7. ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ Ğ² Kafka Ñ‚Ğ¾Ğ¿Ğ¸Ğº

Ğ­Ñ‚Ğ°Ğ¿ 3: ĞŸĞµÑ€ĞµÑ…Ğ¾Ğ´ Ğ½Ğ° CDC
8. ĞŸĞ¾ÑĞ»Ğµ ÑĞ½Ğ°Ğ¿ÑˆĞ¾Ñ‚Ğ° Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡Ğ°ĞµÑ‚ÑÑ Ğ½Ğ° Ñ‡Ñ‚ĞµĞ½Ğ¸Ğµ Ğ¸Ğ· WAL
9. Ğ¢ĞµĞ¿ĞµÑ€ÑŒ ÑĞ»ÑƒÑˆĞ°ĞµÑ‚ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸
```

**Ğ’ ÑÑ‚Ğ¾Ñ‚ Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚ Ğ² PostgreSQL Ğ¿Ğ¾ÑĞ²Ğ»ÑĞµÑ‚ÑÑ:**
```sql
SELECT slot_name, active, restart_lsn, confirmed_flush_lsn 
FROM pg_replication_slots;
-- Ğ’Ğ¸Ğ´Ğ¸Ğ¼: flink_slot_001 | t | 0/16A3B58 | 0/16A3B58
```

---

## ğŸ”„ Ğ¨Ğ°Ğ³ 7: Ğ˜Ğ½ĞºÑ€ĞµĞ¼ĞµĞ½Ñ‚Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ñ€ĞµĞ¿Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ñ (T7)

**Ğ¢ĞµĞ¿ĞµÑ€ÑŒ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ğ² steady-state:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PostgreSQL          Debezium          Kafka     Flink    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  UPDATE users      Ğ§Ğ¸Ñ‚Ğ°ĞµÑ‚ Ğ¸Ğ·       ĞŸÑ€Ğ¸Ğ½Ğ¸Ğ¼Ğ°ĞµÑ‚   Ğ§Ğ¸Ñ‚Ğ°ĞµÑ‚    â”‚
â”‚  SET name='Bob'    ÑĞ»Ğ¾Ñ‚Ğ° Ñ€ĞµĞ¿Ğ»Ğ¸ĞºĞ°-  ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ â†’   Ğ¸Ğ· Ñ‚Ğ¾Ğ¿Ğ¸ĞºĞ° â”‚
â”‚  WHERE id=1        Ñ†Ğ¸Ğ¸ (pgoutput)  Ñ‚Ğ¾Ğ¿Ğ¸Ğº CDC   â†’ Ğ¾Ğ±Ñ€Ğ°-   â”‚
â”‚                    â†“               â†“           Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚   â”‚
â”‚  WAL: 0/16A3B60 â†’  JSON ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ â†’  Ğ¡Ğ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ â†’ Filter â†’  â”‚
â”‚                    {"op": "u",      Ğ² Ğ¿Ğ°Ñ€Ñ‚Ğ¸-    Map â†’     â”‚
â”‚                     "before":...,   Ñ†Ğ¸Ğ¸ 0       Print     â”‚
â”‚                     "after":...}               â†“          â”‚
â”‚  LSN Ğ¿Ñ€Ğ¾Ğ´Ğ²Ğ¸Ğ³Ğ°ĞµÑ‚ÑÑ                        Ğ’Ñ‹Ğ²Ğ¾Ğ´ Ğ² ĞºĞ¾Ğ½ÑĞ¾Ğ»ÑŒ:â”‚
â”‚  0/16A3B60 â†’ 0/16A3B68                   (1, 'Bob', ...) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ› ï¸ Ğ¨Ğ°Ğ³ 8: ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ğ¸ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ

**Ğ§Ñ‚Ğ¾ Ğ³Ğ´Ğµ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑÑ‚ÑŒ:**

1. **Flink Dashboard** (`localhost:8081`):
   - Running Jobs
   - Task Slots usage
   - Checkpoints completed/failed

2. **PostgreSQL:**
   ```sql
   -- Ğ›Ğ°Ğ³ Ñ€ĞµĞ¿Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸
   SELECT slot_name, 
          pg_size_pretty(
            pg_wal_lsn_diff(
              pg_current_wal_lsn(), 
              confirmed_flush_lsn
            )
          ) AS replication_lag
   FROM pg_replication_slots;
   
   -- ĞĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ
   SELECT * FROM pg_stat_replication;
   ```

3. **Kafka:**
   ```bash
   # ĞŸĞ¾Ñ‚Ñ€ĞµĞ±Ğ»ĞµĞ½Ğ¸Ğµ Ñ‚Ğ¾Ğ¿Ğ¸ĞºĞ°
   ./bin/kafka-consumer-groups.sh --describe \
     --group flink-cdc-group \
     --bootstrap-server localhost:9092
   ```

---

## ğŸ¯ ĞšÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚Ñ‹ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸

| Ğ’Ñ€ĞµĞ¼Ñ | Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ | Ğ”Ğ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ | Ğ Ğ¸ÑĞºĞ¸ |
|-------|---------|--------------|-------|
| T0-T1 | Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Flink | 5-10 Ğ¼Ğ¸Ğ½ | ĞĞµÑ‚ |
| T5 | Ğ—Ğ°Ğ¿ÑƒÑĞº Flink Job | 1-2 Ğ¼Ğ¸Ğ½ | ĞÑˆĞ¸Ğ±ĞºĞ¸ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸ |
| T6 | ĞĞ°Ñ‡Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ ÑĞ½Ğ¸Ğ¼Ğ¾Ğº | Ğ—Ğ°Ğ²Ğ¸ÑĞ¸Ñ‚ Ğ¾Ñ‚ Ğ¾Ğ±ÑŠĞµĞ¼Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… | Ğ‘Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²ĞºĞ° Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ† |
| T6â†’T7 | ĞŸĞµÑ€ĞµÑ…Ğ¾Ğ´ Ğ½Ğ° CDC | ĞœĞ³Ğ½Ğ¾Ğ²ĞµĞ½Ğ½Ğ¾ | ĞŸĞ¾Ñ‚ĞµÑ€Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¿Ñ€Ğ¸ ÑĞ±Ğ¾Ğµ |
| Steady | Ğ˜Ğ½ĞºÑ€ĞµĞ¼ĞµĞ½Ñ‚Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ñ€ĞµĞ¿Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ñ | ĞŸĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ½Ğ¾ | Ğ Ğ¾ÑÑ‚ Ğ»Ğ°Ğ³Ğ°, Ğ¿ĞµÑ€ĞµĞ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ ÑĞ»Ğ¾Ñ‚Ğ° |

---

## ğŸ’¡ ĞŸÑ€Ğ°ĞºÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ ÑĞ¾Ğ²ĞµÑ‚Ñ‹ Ğ´Ğ»Ñ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ³Ğ¾ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°

1. **ĞĞ°Ñ‡Ğ½Ğ¸Ñ‚Ğµ Ñ Ğ¾Ğ´Ğ½Ğ¾Ğ¹ Ğ¼Ğ°Ğ»ĞµĞ½ÑŒĞºĞ¾Ğ¹ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹** (100-1000 Ğ·Ğ°Ğ¿Ğ¸ÑĞµĞ¹)
2. **Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ `'scan.startup.mode' = 'earliest-offset'`** Ğ´Ğ»Ñ Ñ‡Ñ‚ĞµĞ½Ğ¸Ñ Ğ²ÑĞµÑ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
3. **Ğ’ĞºĞ»ÑÑ‡Ğ¸Ñ‚Ğµ Ğ»Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ** Ğ´Ğ»Ñ Ğ¾Ñ‚Ğ»Ğ°Ğ´ĞºĞ¸:
   ```bash
   tail -f log/flink-*-taskexecutor-*.log
   ```
4. **ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞ¹Ñ‚Ğµ ĞºĞ°Ğ¶Ğ´ÑƒÑ ÑÑ‚ÑƒĞ¿ĞµĞ½ÑŒĞºÑƒ** Ğ¿ĞµÑ€ĞµĞ´ Ğ¿ĞµÑ€ĞµÑ…Ğ¾Ğ´Ğ¾Ğ¼ Ğº ÑĞ»ĞµĞ´ÑƒÑÑ‰ĞµĞ¹
5. **Ğ¡Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ° Ğ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚Ğµ Ğ±ĞµĞ· Ğ¿Ñ€ĞµĞ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¹** - Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾ `SELECT * FROM users_cdc`

Ğ­Ñ‚Ğ° Ğ¿Ğ¾ÑÑ‚Ğ°Ğ¿Ğ½Ğ°Ñ ÑˆĞºĞ°Ğ»Ğ° Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚, ĞºĞ°Ğº ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹ **Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ÑÑ‚ÑÑ, ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ¸Ñ€ÑƒÑÑ‚ÑÑ Ğ¸ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°ÑÑ‚ÑÑ Ğ² ÑÑ‚Ñ€Ğ¾Ğ³Ğ¾Ğ¹ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸**. ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ ÑˆĞ°Ğ³ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ñ‚ Ğ¾Ñ‚ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾Ğ³Ğ¾ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ñ Ğ¿Ñ€ĞµĞ´Ñ‹Ğ´ÑƒÑ‰ĞµĞ³Ğ¾.
