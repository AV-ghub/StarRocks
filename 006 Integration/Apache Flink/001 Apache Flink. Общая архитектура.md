##### [Configuring Flink application resources](https://docs.cloudera.com/csa/1.13.4/how-to-flink/topics/csa-other-configs.html)

## üèóÔ∏è –û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö –æ—Ç –ë–î –¥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```
[–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö]
      |
      ‚ñº
[PostgreSQL] ‚Üí –õ–æ–≥–∏—á–µ—Å–∫–∞—è —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è ‚Üí WAL ‚Üí –õ–æ–≥–∏—á–µ—Å–∫–∏–π –¥–µ–∫–æ–¥–µ—Ä (pgoutput)
      |                                          |
      | (Debezium —á–∏—Ç–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è)              |
      ‚ñº                                          |
[Debezium Connector] ‚Üí –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –≤ —Å–æ–±—ã—Ç–∏—è    |
      |                                          |
      ‚ñº                                          |
[Apache Kafka] ‚Üí –¢–æ–ø–∏–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–π —Ç–∞–±–ª–∏—Ü—ã       |
      |                                          |
      ‚ñº                                          |
[Flink Job] ‚Üí –û–±—Ä–∞–±–æ—Ç–∫–∞, —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è, –∞–≥—Ä–µ–≥–∞—Ü–∏—è
      |
      ‚ñº
[–°—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö] ‚Üí –î—Ä—É–≥–∞—è –ë–î, Kafka, API –∏ —Ç.–¥.
```

## üì¶ –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞–∂–¥–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞

### 1. **–£—Ä–æ–≤–µ–Ω—å –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö (PostgreSQL)**

–ó–¥–µ—Å—å –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç **–∑–∞—Ö–≤–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π** (CDC - Change Data Capture):

```sql
-- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ PostgreSQL
CREATE PUBLICATION flink_pub FOR TABLE users, orders, products;
CREATE USER debezium WITH REPLICATION LOGIN;
GRANT SELECT ON users, orders, products TO debezium;
```

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã:**
- **WAL (Write-Ahead Log)** ‚Äî –∂—É—Ä–Ω–∞–ª, –∫—É–¥–∞ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- **–õ–æ–≥–∏—á–µ—Å–∫–∏–π –¥–µ–∫–æ–¥–µ—Ä (pgoutput)** ‚Äî –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –±–∏–Ω–∞—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ WAL –≤ –ª–æ–≥–∏—á–µ—Å–∫–∏–π —Ñ–æ—Ä–º–∞—Ç
- **–°–ª–æ—Ç —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏** ‚Äî —É–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏—é –≤ WAL, —á—Ç–æ–±—ã –∑–Ω–∞—Ç—å, –∫–∞–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —É–∂–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã

### 2. **–£—Ä–æ–≤–µ–Ω—å –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä–∞ (Debezium)**

Debezium —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ **–º–æ—Å—Ç** –º–µ–∂–¥—É PostgreSQL –∏ Kafka:

```
Debezium Connector (–≤ —Å–æ—Å—Ç–∞–≤–µ Flink)
‚îú‚îÄ‚îÄ –ò—Å—Ç–æ—á–Ω–∏–∫: —á–∏—Ç–∞–µ—Ç –∏–∑ —Å–ª–æ—Ç–∞ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å: –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Å–æ–±—ã—Ç–∏—è
‚îú‚îÄ‚îÄ –§–∏–ª—å—Ç—Ä: –æ—Ç–±–∏—Ä–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã/—Å—Ç–æ–ª–±—Ü—ã
‚îî‚îÄ‚îÄ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏—è –≤ Kafka
```

**–ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ connector.properties:**
```properties
name=postgres-connector
connector.class=io.debezium.connector.postgresql.PostgresConnector
database.hostname=postgres-host
database.dbname=mydb
plugin.name=pgoutput
publication.name=flink_pub
table.include.list=public.users,public.orders
slot.name=flink_slot
```

### 3. **–£—Ä–æ–≤–µ–Ω—å –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö (Apache Kafka)**

–ó–¥–µ—Å—å –¥–∞–Ω–Ω—ã–µ **–±—É—Ñ–µ—Ä–∏–∑—É—é—Ç—Å—è –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è**:

- **–¢–æ–ø–∏–∫–∏**: `server.mydb.public.users`, `server.mydb.public.orders`
- **–°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö**: Avro/JSON Schema –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- **–ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ø–æ –∫–ª—é—á—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, user_id)
- **–†–µ—Ç–µ–Ω—à–Ω**: –∫–∞–∫ –¥–æ–ª–≥–æ —Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ (—á–∞—Å—ã/–¥–Ω–∏)

### 4. **–£—Ä–æ–≤–µ–Ω—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ (Apache Flink)**

–°–µ—Ä–¥—Ü–µ —Å–∏—Å—Ç–µ–º—ã ‚Äî **–ø–æ—Ç–æ–∫–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**:

```java
// –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π –ø—Ä–∏–º–µ—Ä Flink Job
DataStream<ChangeEvent> source = env
    .fromSource(kafkaSource, WatermarkStrategy.noWatermarks(), "Kafka Source");

source
    .filter(event -> event.op != "DELETE")  // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è
    .keyBy(event -> event.userId)           // –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞
    .window(TumblingProcessingTimeWindows.of(Time.minutes(5)))
    .aggregate(new OrderAggregator())       // –ê–≥—Ä–µ–≥–∞—Ü–∏—è
    .sinkTo(kafkaSink);                     // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–ª—å—à–µ
```

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã Flink:**
- **JobManager**: —É–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–¥–∞—á–∞–º–∏
- **TaskManager**: –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–¥–∞—á–∏
- **Checkpointing**: –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç exactly-once —Å–µ–º–∞–Ω—Ç–∏–∫—É
- **State Backend**: —Ö—Ä–∞–Ω–∏—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ (RocksDB, Heap)

### 5. **–£—Ä–æ–≤–µ–Ω—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞**

**–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã:**
```
–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
‚îú‚îÄ‚îÄ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: .yaml —Ñ–∞–π–ª—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
‚îú‚îÄ‚îÄ –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è: Docker Compose / Kubernetes
‚îú‚îÄ‚îÄ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥: –º–µ—Ç—Ä–∏–∫–∏, –ª–æ–≥–∏, –∞–ª–µ—Ä—Ç—ã
‚îî‚îÄ‚îÄ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: SSL, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
```

## üîÑ –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã

1. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ PostgreSQL** ‚Üí —Å–æ–∑–¥–∞–Ω–∏–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–π, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
2. **–ó–∞–ø—É—Å–∫ Kafka** ‚Üí —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–ø–∏–∫–æ–≤, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ ACL
3. **–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ Debezium** ‚Üí —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä–∞
4. **–ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π —Å–Ω–∏–º–æ–∫** ‚Üí –ø–æ–ª–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
5. **–ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è** ‚Üí –ø–æ—Ç–æ–∫–æ–≤–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π
6. **–ó–∞–ø—É—Å–∫ Flink Job** ‚Üí –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Ç–æ–∫–∞ —Å–æ–±—ã—Ç–∏–π
7. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** ‚Üí –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ª–∞–≥–æ–≤, –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

## üéØ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–∫–∞–∑–æ–≤

–î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–π–¥–µ–º –ø—É—Ç—å –æ–¥–Ω–æ–≥–æ **–∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞**:

1. **PostgreSQL**: `UPDATE orders SET status='shipped' WHERE id=123`
2. **WAL**: –∑–∞–ø–∏—Å—å –≤ –∂—É—Ä–Ω–∞–ª —Å LSN (Log Sequence Number) 0x16A/0x3018B0A0
3. **Debezium**: —á–∏—Ç–∞–µ—Ç –∏–∑ —Å–ª–æ—Ç–∞, –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤ —Å–æ–±—ã—Ç–∏–µ:
   ```json
   {
     "before": {"id": 123, "status": "processing"},
     "after": {"id": 123, "status": "shipped"},
     "op": "u", "ts_ms": 1625097600000,
     "source": {"db": "mydb", "table": "orders"}
   }
   ```
4. **Kafka**: —Å–æ–±—ã—Ç–∏–µ –ø–æ–º–µ—â–∞–µ—Ç—Å—è –≤ —Ç–æ–ø–∏–∫ `server.mydb.public.orders`
5. **Flink**: –æ–±—Ä–∞–±–æ—Ç–∫–∞:
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –¥–∞—à–±–æ—Ä–¥–∞
   - –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç—É
   - –ê–≥—Ä–µ–≥–∞—Ü–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º
6. **–°—Ç–æ–∫**: –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ Elasticsearch –¥–ª—è –ø–æ–∏—Å–∫–∞

–≠—Ç–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–∞–µ—Ç –≤–∞–º **–ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å** –Ω–∞ –∫–∞–∂–¥–æ–º —É—Ä–æ–≤–Ω–µ. –í—ã –º–æ–∂–µ—Ç–µ:
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –Ω–∞ —É—Ä–æ–≤–Ω–µ PostgreSQL (–ø—É–±–ª–∏–∫–∞—Ü–∏–∏)
- –î—É–±–ª–∏—Ä–æ–≤–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –Ω–∞ —É—Ä–æ–≤–Ω–µ Debezium (table.include.list)
- –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ Flink (–æ–±–æ–≥–∞—â–µ–Ω–∏–µ, –∞–≥—Ä–µ–≥–∞—Ü–∏—è)
- –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–µ—Ç—Ä–∏–∫


