–ù—É–∂–Ω–æ –Ω–µ "—É–¥–∞–ª–∏—Ç—å —Ç–æ—á–∫—É —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è", –∞ **—Å–±—Ä–æ—Å–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä —Å–µ—Å—Å–∏–∏ –∏ –æ—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –∑–∞–¥–∞–Ω–∏–µ**, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ. 

### üîÑ –®–∞–≥ 1: –°–±—Ä–æ—Å—å—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä savepoint –≤ —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏
–í–Ω—É—Ç—Ä–∏ –≤–∞—à–µ–≥–æ Flink SQL Client –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É:
```sql
RESET 'execution.savepoint.path';
```
–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ —É–¥–∞–ª–∏—Ç –≥–ª–æ–±–∞–ª—å–Ω—É—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –¥–ª—è —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏. –¢–µ–ø–µ—Ä—å —Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–ø—É—Å–∫–∏ –∑–∞–¥–∞–Ω–∏–π –±—É–¥—É—Ç –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å —á–∏—Å—Ç–æ–≥–æ –ª–∏—Å—Ç–∞.

### üóëÔ∏è –®–∞–≥ 2: –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ (–æ—Ç–º–µ–Ω–∏—Ç–µ) –≤—Å–µ —Ç–µ–∫—É—â–∏–µ –∑–∞–¥–∞–Ω–∏—è
–ß—Ç–æ–±—ã –æ—Å–≤–æ–±–æ–¥–∏—Ç—å —Å–ª–æ—Ç —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –∏ –¥—Ä—É–≥–∏–µ —Ä–µ—Å—É—Ä—Å—ã, **–æ—Ç–º–µ–Ω–∏—Ç–µ –≤—Å–µ –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è**, –∫–æ—Ç–æ—Ä—ã–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—Ç.

1.  **–ù–∞–π–¥–∏—Ç–µ ID –≤—Å–µ—Ö –∑–∞–¥–∞–Ω–∏–π** (–≤ —Ç–æ–º —á–∏—Å–ª–µ —É–ø–∞–≤—à–∏—Ö –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—é—â–∏—Ö—Å—è):
    ```bash
    ./bin/flink list
    ```
    –ò–ª–∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ Flink (`http://localhost:8081`).

2.  **–û—Ç–º–µ–Ω–∏—Ç–µ –∫–∞–∂–¥–æ–µ –∑–∞–¥–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥–æ–π `cancel`**:
    ```bash
    ./bin/flink cancel <JOB_ID>
    ```
    **–í–∞–∂–Ω–æ**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–º–µ–Ω–Ω–æ `cancel`, –∞ –Ω–µ `stop`, —Ç–∞–∫ –∫–∞–∫ `stop` –ø–æ–ø—ã—Ç–∞–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å *–Ω–æ–≤—ã–π* savepoint, –∫–æ—Ç–æ—Ä—ã–π –≤–∞–º —Å–µ–π—á–∞—Å –Ω–µ –Ω—É–∂–µ–Ω.

### üóëÔ∏è (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –®–∞–≥ 3: –£–¥–∞–ª–∏—Ç–µ —Å—Ç–∞—Ä—ã–π savepoint —Å –¥–∏—Å–∫–∞
–ï—Å–ª–∏ —Ñ–∞–π–ª savepoint –≤–∞–º –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–µ–Ω, –µ–≥–æ –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –≤—Ä—É—á–Ω—É—é. –≠—Ç–æ –ø—Ä–æ—Å—Ç–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –Ω–∞ –¥–∏—Å–∫–µ:
```bash
rm -rf /home/sruser/flink-1.20.3/savepoints/savepoint-7c0485-a332dd11e80a
```

### üöÄ –®–∞–≥ 4: –ù–∞—á–Ω–∏—Ç–µ —Å —á–∏—Å—Ç–æ–≥–æ –ª–∏—Å—Ç–∞
–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —à–∞–≥–æ–≤ 1-3 –≤—ã –≥–æ—Ç–æ–≤—ã –Ω–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ.

1.  **–û—Å—Ç–∞–Ω—å—Ç–µ—Å—å –≤ —Ç–æ–π –∂–µ —Å–µ—Å—Å–∏–∏ SQL Client** (–∏–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–æ–≤—É—é).
2.  **–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–∞—Ä–∞–º–µ—Ç—Ä —Å–±—Ä–æ—à–µ–Ω** (–º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å `RESET;` –¥–ª—è —Å–±—Ä–æ—Å–∞ –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤).
3.  **–í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤–∞—à –∏—Å—Ö–æ–¥–Ω—ã–π SQL-—Å–∫—Ä–∏–ø—Ç** –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü –∏ –∑–∞–ø—É—Å–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ **–±–µ–∑ –∫–∞–∫–æ–π-–ª–∏–±–æ —Å—Å—ã–ª–∫–∏ –Ω–∞ savepoint**.

### üí° –ö—Ä–∞—Ç–∫–∏–π —á–µ–∫-–ª–∏—Å—Ç –¥–ª—è "–∂—ë—Å—Ç–∫–æ–≥–æ" –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
–ß—Ç–æ–±—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –Ω–∞—á–∞—Ç—å –≤—Å—ë —Å –Ω—É–ª—è, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —ç—Ç—É –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:

```bash
# 1. –í–æ–π–¥–∏—Ç–µ –≤ SQL Client
./bin/sql-client.sh

# 2. –í —Å–µ—Å—Å–∏–∏ SQL —Å–±—Ä–æ—Å—å—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä
RESET 'execution.savepoint.path';

# 3. –í—ã–π–¥–∏—Ç–µ –∏–∑ SQL Client
EXIT;

# 4. –í –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ Flink –æ—Ç–º–µ–Ω–∏—Ç–µ –≤—Å–µ –∑–∞–¥–∞–Ω–∏—è
./bin/flink list  # –ó–∞–ø–æ–º–Ω–∏—Ç–µ ID
./bin/flink cancel <JOB_ID_1>
./bin/flink cancel <JOB_ID_2>

# 5. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –£–¥–∞–ª–∏—Ç–µ —Å—Ç–∞—Ä—ã–µ savepoints
rm -rf /home/sruser/flink-1.20.3/savepoints/*

# 6. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–ª–∞—Å—Ç–µ—Ä Flink (–¥–ª—è –ø–æ–ª–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –ø–∞–º—è—Ç–∏)
./bin/stop-cluster.sh
./bin/start-cluster.sh

# 7. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∑–∞–¥–∞–Ω–∏–µ –∑–∞–Ω–æ–≤–æ, –∫–∞–∫ –≤ —Å–∞–º—ã–π –ø–µ—Ä–≤—ã–π —Ä–∞–∑
./bin/sql-client.sh -f /–ø—É—Ç—å/–∫/–≤–∞—à–µ–º—É/–æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º—É_—Å–∫—Ä–∏–ø—Ç—É.sql
```

### ‚ö†Ô∏è –í–∞–∂–Ω—ã–π –Ω—é–∞–Ω—Å: –°–ª–æ—Ç —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ PostgreSQL
–ü–æ—Å–ª–µ –æ—Ç–º–µ–Ω—ã –∑–∞–¥–∞–Ω–∏–π **—Å–ª–æ—Ç —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –≤ PostgreSQL (`flink_cdc_demo_slot`) –æ—Å—Ç–∞–Ω–µ—Ç—Å—è**. Flink –¥–æ–ª–∂–µ–Ω –±—ã–ª –æ—Å–≤–æ–±–æ–¥–∏—Ç—å –µ–≥–æ, –Ω–æ –∏–Ω–æ–≥–¥–∞ –æ–Ω "–∑–∞–≤–∏—Å–∞–µ—Ç". –ü–µ—Ä–µ–¥ –Ω–æ–≤—ã–º –∑–∞–ø—É—Å–∫–æ–º **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ**:
```sql
SELECT slot_name, active, pg_wal_lsn_diff(pg_current_wal_lsn(), confirmed_flush_lsn) AS lag
FROM pg_replication_slots;
```
–ï—Å–ª–∏ —Å–ª–æ—Ç –Ω–µ–∞–∫—Ç–∏–≤–µ–Ω (`active = f`), –Ω–æ –æ—Ç—Å—Ç–∞–≤–∞–Ω–∏–µ (`lag`) –≤–µ–ª–∏–∫–æ, –µ–≥–æ –º–æ–∂–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ —É–¥–∞–ª–∏—Ç—å –∏ —Å–æ–∑–¥–∞—Ç—å –∑–∞–Ω–æ–≤–æ –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–ø—É—Å–∫–µ –∑–∞–¥–∞–Ω–∏—è. –ó–∞–¥–∞–Ω–∏–µ Flink CDC —Å–æ–∑–¥–∞—Å—Ç –µ–≥–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –µ—Å–ª–∏ –æ–Ω —É–∫–∞–∑–∞–Ω –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (`slot.name`), –Ω–æ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤–∞—à –ø–∞–π–ø–ª–∞–π–Ω –¥–æ–ª–∂–µ–Ω –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è —Å —á–∏—Å—Ç–æ–≥–æ –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —Å–Ω–∞–ø—à–æ—Ç–∞.
